<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="icon.png" type="image/png">
    <title>Dashboard</title>

    <!-- Modern UI Theme CSS -->
    <link rel="stylesheet" href="css/modern-ui-theme.css">

    <!-- Bootstrap CSS (optional, if you want to use Bootstrap components/grid) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="../css/dashboard.css">

    <style>
        /* Move inline styles here or to dashboard.css */
        #map { height: 60vh; }
        #reports { height: 40vh; overflow-y: auto; }
        #filters { margin-top: 10px; }
        #hazard-types-container { display:none; }
        #report-sidebar {
            position: fixed;
            top: 0;
            right: -300px; /* Hidden by default */
            width: 300px;
            height: 100%;
            background-color: var(--card-bg); /* Use theme background */
            color: var(--text); /* Use theme text color */
            padding: 20px;
            box-shadow: -3px 0 10px rgba(0,0,0,0.3);
            transition: right 0.3s ease-in-out;
            z-index: 1050; /* Higher than navigation sidebar */
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- כפתור פתיחת/סגירת התפריט -->
    <button class="sidebar-toggle-btn" id="sidebarToggle">☰</button>

    <!-- תפריט הצד -->
    <nav id="mySidebar" class="sidebar">
        <div class="sidebar-header">
            <a href="javascript:void(0)" class="close-btn" id="sidebarCloseBtn">×</a>
            <h3>תפריט</h3>
        </div>
        <a href="/dashboard.html" class="nav-link active">Dashboard</a> <!-- הוספת active לקלאס -->
        <a href="/upload.html" class="nav-link">Upload Image</a>
        <a href="/camera.html" class="nav-link">Live Detection</a>
        <!-- עוד קישורים -->
    </nav>

    <!-- תוכן ראשי של הדף -->
    <div id="mainContent" class="main-content">
        <div id="dashboard-container" class="container mt-4 mb-5"> <!-- Added Bootstrap container classes -->
            <h1>Dashboard</h1>

            <!-- Google Map -->
            <div id="map"></div>


        <div id="top-buttons">
            <!-- Toggle Buttons in the same row -->
            <button id="toggleMapBtn">Maximize Map</button>
            <button id="toggleBtn">Maximize Reports</button>
            <button id="toggle-filters-btn">Show Filters</button>
        </div>

        <!-- Filters Section (Initially Hidden) -->
        <div id="filters">
            <h3 class="mt-3 mb-2">Search Filters</h3> <!-- Added margin classes -->

            <!-- Hazard Type Filter -->
            <button id="toggle-hazard-types-btn">Select Hazard Types</button>
            <div id="hazard-types-container" style="display:none;">
                <!-- Dynamically populated hazard types will go here -->
            </div>

            <!-- Location Filter -->
            <label for="location" class="form-label">Location:</label> <!-- Added form-label -->
            <input type="text" id="location" placeholder="Enter Location (e.g., Haifa)">

            <!-- Report Time Filter -->
            <label for="start-date" class="form-label">Date Range:</label> <!-- Added form-label -->
            <input type="date" id="start-date">
            <input type="date" id="end-date">
            
            <!-- Status Filter -->
            <label for="status">Status:</label>
            <select id="status">
                <option value="">All Statuses</option>
                <option value="new">New</option>
                <option value="in progress">In Progress</option>
                <option value="resolved">Resolved</option>
            </select>

            <!-- Reported By Filter -->
            <label for="reported-by" class="form-label">Username:</label> <!-- Added form-label -->
            <input type="text" id="reported-by" placeholder="Enter username">

            <!-- Search Button -->
            <button id="search-btn" class="btn btn-primary me-2">Search</button> <!-- Added Bootstrap button classes -->
            
            <!-- Clear Filters Button -->
            <button id="clear-filters-btn">Clear Filters</button>
        </div>

        <!-- Reports Table -->
        <div id="reports" style="height: 40vh; overflow-y: auto;">
            <h2 class="mt-4 mb-2">Reports Log</h2> <!-- Added margin classes -->
            <table>
                <thead>
                    <tr>
                        <th>Hazard ID</th>
                        <th>Hazard Type</th>
                        <th>Location</th>
                        <th>Report Time</th>
                        <th>Image</th>
                        <th>Status</th>
                        <th>Reported By</th>
                    </tr>
                </thead>
                <tbody id="reports-body">
                    <!-- Reports will be dynamically populated here -->
                </tbody>
            </table>
        </div>
        </div> <!-- סוף ה-dashboard-container -->
    </div>

    <!-- Sidebar for displaying selected report details - (Will be replaced by a modal) -->
    <div id="report-sidebar">
        <h3>Report Details</h3>
        <p><strong>Hazard ID:</strong> <span id="sidebar-hazard-id"></span></p>
        <p><strong>Hazard Type:</strong> <span id="sidebar-type"></span></p>
        <p><strong>Location:</strong> <span id="sidebar-location"></span></p>
        <p><strong>Report Time:</strong> <span id="sidebar-time"></span></p>
        <p><strong>Status:</strong> <span id="sidebar-status"></span></p>
        <p><strong>Reported By:</strong> <span id="sidebar-user"></span></p>
        <img id="sidebar-image" src="" alt="Hazard Image" class="img-fluid mt-3"> <!-- Added img-fluid for responsiveness -->
        <button onclick="closeSidebar()" class="btn btn-secondary mt-3">Close</button> <!-- Added Bootstrap button classes -->
    </div>

    <!-- Modal for Report Details -->
    <div class="modal fade" id="reportDetailsModal" tabindex="-1" aria-labelledby="reportDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reportDetailsModalLabel">Report Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Hazard ID:</strong> <span id="modal-hazard-id"></span></p>
                    <p><strong>Hazard Type:</strong> <span id="modal-type"></span></p>
                    <p><strong>Location:</strong> <span id="modal-location"></span></p>
                    <p><strong>Report Time:</strong> <span id="modal-time"></span></p>
                    <p><strong>Status:</strong> <span id="modal-status"></span></p>
                    <p><strong>Reported By:</strong> <span id="modal-user"></span></p>
                    <img id="modal-report-image" src="" alt="Hazard Image" class="img-fluid mt-3 mb-3" style="max-height: 400px; display: block; margin: 0 auto;">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for displaying large image (Consider using Bootstrap Modal component instead) -->
    <div id="image-modal" style="display:none;">
        <div id="modal-content">
            <span id="close-modal" style="cursor:pointer; position: absolute; top: 10px; right: 10px; font-size: 30px; color: white;">&times;</span>
            <img id="modal-image" src="" alt="Large Image" style="max-width: 90%; max-height: 90vh; display: block; margin: 0 auto;">
        </div>
    </div>

    <!-- Bootstrap JS Bundle (optional) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <!-- JavaScript לשליטה בתפריט הצד -->
    <script>
        const sidebar = document.getElementById('mySidebar');
        const sidebarToggleBtn = document.getElementById('sidebarToggle');
        const sidebarCloseBtn = document.getElementById('sidebarCloseBtn');
        const mainContent = document.getElementById('mainContent');

        function toggleSidebar() {
            sidebar.classList.toggle('open');
            mainContent.classList.toggle('shifted'); // בטל הערה אם רוצים לדחוף תוכן
        }

        sidebarToggleBtn.addEventListener('click', toggleSidebar);
        sidebarCloseBtn.addEventListener('click', toggleSidebar);

        // אופציונלי: סגירת התפריט בלחיצה מחוץ לו
        document.addEventListener('click', function(event) {
            if (sidebar.classList.contains('open') && !sidebar.contains(event.target) && event.target !== sidebarToggleBtn) {
                toggleSidebar();
            }
        });
    </script>
    <script src="../js/dashboard.js" defer></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA9qkNEaiu9vpTB0bzqhw_Ei55Mt2UqN3A&callback=initMap&loading=async" defer></script>
</body>
</html>
