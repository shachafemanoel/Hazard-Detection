<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width,initial-scale=1.0,maximum-scale=1.0,viewport-fit=cover"
  />
  <title>Live Detection – Hazard Detection System</title>

  <!-- Core styles -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/camera.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap" rel="stylesheet">
</head>

<body>
  <main class="camera-app main-content">
    <!-- Video & inference canvas -->
    <section class="camera-view" aria-label="Live camera feed">
      <video id="camera-stream" autoplay playsinline muted></video>
      <canvas id="overlay-canvas" aria-hidden="true"></canvas>
    </section>

    <!-- --------------- UI overlay --------------- -->
    <div class="camera-ui">
      <!-- Top bar -->
      <header class="top-bar">
        <div class="status-indicator">
          <span class="status-dot"></span>
          <span id="loading-status">Loading model…</span>
        </div>
        <span class="model-info">Model best0408.onnx</span>
      </header>

      <!-- Detection badges -->
      <section class="detection-overlay">
        <div class="detection-badge">
          <i class="fas fa-search"></i>
          <span id="detection-count-badge">0 hazards</span>
        </div>
        <div class="detection-badge">
          <i class="fas fa-gauge-high"></i>
          <span id="fps-badge">0 FPS</span>
        </div>
        <div class="detection-badge" id="hazard-types-display" hidden>
          <i class="fas fa-exclamation-triangle"></i>
          <span id="hazard-types-list">—</span>
        </div>
      </section>

      <!-- Bottom controls -->
      <footer class="bottom-controls">
        <button id="start-camera" class="camera-button primary" disabled aria-label="Start">
          <i class="fas fa-play"></i>
        </button>
        <button id="stop-camera"  class="camera-button primary" hidden aria-label="Stop">
          <i class="fas fa-stop"></i>
        </button>
      </footer>

      <!-- Loading overlay -->
      <section class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
      </section>
    </div>
    <!-- ----------------------------------------- -->
  </main>

  <!-- 1️⃣  ONNX Runtime (global `window.ort`) -->
  <script type="module">
    import * as ort from 'https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.mjs';
    window.ort = ort;
  </script>
  <script>
    // Configure ONNX Runtime WASM path for CDN
    if (typeof ort !== 'undefined') {
      ort.env.wasm.wasmPath = 'https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/';
      ort.env.wasm.numThreads = 1; // Or adjust based on your needs
      ort.env.wasm.simd = true; // Enable SIMD if supported
      ort.env.wasm.proxy = true; // Enable proxy for threaded WASM
    }
  </script>

  <!-- 2️⃣  Unified controller -->
  <script type="module" defer src="js/upload_tf.js"></script>
</body>
</html>